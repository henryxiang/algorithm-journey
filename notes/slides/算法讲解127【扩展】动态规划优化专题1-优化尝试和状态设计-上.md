# 优化尝试和状态设计-上

前置知识

讲解066 ~ 讲解088 \- 【必备】阶段动态规划专题

讲解098 \- 矩阵快速幂和动态规划，本节课题目5需要

动态规划优化专题的讲述顺序

专题1：优化尝试和状态设计\-上，讲解127，本节

专题2：优化尝试和状态设计\-下，讲解128

专题3：倍增优化，讲解129

专题4：单调队列/单调栈优化，讲解130

专题5：树状数组/线段树优化，讲解131

专题6：预处理数组优化，讲解132

以上内容是【扩展】课程阶段，动态规划优化的讲述内容

单调性优化的更多内容，比如斜率优化、四边形不等式优化等，会在【挺难】阶段的视频中讲述

题目1

摘樱桃

给定一个n\*n的正方形矩阵grid，每个格子值只有三种\-1、0、1

\-1表示格子不能走、0表示格子可以走但是没有樱桃、1表示格子可以走且有一颗樱桃

你的目标是从左上角走到右下角，每一步只能 向下 或者 向右

然后从右下角走回左上角，每一步只能 向上 或者 向左

这个过程中，想尽量多的获得樱桃，但是有樱桃的格子，只能捡一次

返回最多能获得多少樱桃，如果不存在通路返回0

测试链接 : [https://leetcode\.cn/problems/cherry\-pickup/](https://leetcode.cn/problems/cherry-pickup/)

可以分析出贪心的方法不行

一来一回的问题往往转化为双倍起点的问题

题目2

上学需要的最少跳跃能力

青蛙住在一条河边，家在0位置\, 每天到河对岸的上学，学校在n位置

河里的石头排成了一条直线，青蛙每次跳跃必须落在一块石头或者岸上

给定一个长度为n\-1的数组arr，表示1~n\-1位置每块石头的高度数值

每次青蛙从一块石头起跳，这块石头的高度就会下降1

当石头的高度下降到0时，青蛙不能再跳到这块石头上，跳跃后使石头高度下降到0是允许的

青蛙一共需要去学校上x天课\, 所以它需要往返x次，青蛙具有跳跃能力y\, 它可以跳跃不超过y的距离

请问青蛙的跳跃能力至少是多少，才能用这些石头往返x次

1 <= n <= 10^5   1 <= arr\[i\] <= 10^4   1 <= x <= 10^9

测试链接 : [https://www\.luogu\.com\.cn/problem/P8775](https://www.luogu.com.cn/problem/P8775)

一来一回的问题往往转化为双倍起点的问题，本题还有一个很秀的分析

题目3

相乘为正或负的子数组数量

给定一个长度为n的数组arr，其中所有值都不是0

返回有多少个子数组相乘的结果是正

返回有多少个子数组相乘的结果是负

1 <= n <= 10^6

\-10^9 <= arr\[i\] <= \+10^9，arr\[i\]一定不是0

来自真实大厂笔试，对数器验证

对乘法来说：

正正得正、负负得正、正负得负、负正得负

完美对应0和1之间的异或运算

0^0=0、1^1=0、0^1=1、1^0=1，进而优化计算

推荐看一下，讲解046 \- 构建前缀信息的技巧，解决子数组相关问题

题目4

相邻与结果不为0的最长子序列

给定一个长度为n的数组arr，你可以随意选择数字组成子序列

但是要求任意相邻的两个数&的结果不能是0，这样的子序列才是合法的

返回最长合法子序列的长度

1 <= n <= 10^5

0 <= arr\[i\] <= 10^9

测试链接 : [https://www\.luogu\.com\.cn/problem/P4310](https://www.luogu.com.cn/problem/P4310)

可能性分析时，增加每一位的可能性枚举，反正最多只有32位

题目5

摆盘子的方法

一共有n个盘子，k种菜，所有盘子排成一排，每个盘子只能放一种菜

要求最多连续两个盘子菜品一样，更长的重复出现是不允许的

返回摆盘的方法数，答案可能很大，对1000000007取余

1 <= n <= 1000

1 <= k <= 1000

来自真实大厂笔试，对数器验证

本题的最优解能做到O\(log n\)，需要掌握，讲解098 \- 矩阵快速幂

题目6

过河踩过的最少石子数

在河上有一座独木桥，一只青蛙想沿着独木桥从河的一侧跳到另一侧

在桥上有一些石子，青蛙很讨厌踩在这些石子上

我们可以把独木桥上青蛙可能到达的点看成数轴上的一串整点0\.\.\.n

其中n是桥的长度，坐标为0的点表示桥的起点，坐标为n的点表示桥的终点

青蛙从桥的起点开始，不停的向终点方向跳跃，一次跳跃的距离是\[s\,t\]之间的任意正整数

当青蛙跳到或跳过坐标为n的点时，就算青蛙已经跳出了独木桥

题目给出独木桥的长度n，青蛙跳跃的距离范围s、t，题目还给定m个桥上石子的位置

你的任务是确定青蛙要想过河，最少需要踩到的石子数

1 <= n <= 10^7   1 <= s <= t <= 10   1 <= m <= 100

测试链接 : https://www\.luogu\.com\.cn/problem/P1052

胡搞 或者 对数器做实验，得到一个很重要的离散化细节，课上重点图解

