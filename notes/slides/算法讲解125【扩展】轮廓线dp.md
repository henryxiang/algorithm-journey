# 轮廓线dp

前置知识

讲解080、讲解081 -  _状压dp_

系统学习动态规划看讲解066~讲解088，其中有动态规划原理 + 空间压缩技巧图解

本节课讲述

位运算的几个简单操作

轮廓线dp原理及其空间压缩技巧

轮廓线dp的4个相关题目

注意：

插头dp也叫连通性状压dp，这是轮廓线dp中更难的内容

对于致力比赛的同学来说，插头dp也算偏、难、怪的范畴

本系列视频，不再安排讲述插头dp的相关内容，有兴趣的同学可以自行研究

位运算的几个简单操作

得到状态s第j位的状态 : (s >> j) & 1

把状态s第j位的状态设置成1，其他位置状态不变 : s = s | (1 << j)

把状态s第j位的状态设置成0，其他位置状态不变 : s = s & (~(1 << j))

题目1

种草的方法数

给定一个n*m的二维网格grid

网格里只有0、1两种值，0表示该田地不能种草，1表示该田地可以种草

种草的时候，任何两个种了草的田地不能相邻，相邻包括上、下、左、右四个方向

你可以随意决定种多少草，只要不破坏上面的规则即可

返回种草的方法数，答案对100000000取模

1 <= n, m <= 12

测试链接 : https://www.luogu.com.cn/problem/P1879

1，普通状压dp的实现

2，轮廓线dp的实现

3，轮廓线dp+空间压缩的实现

课上重点图解

普通状压dp的困境

二维网格中需要逐行逐列做决策时，状态信息表示上一行的状况

那么得到当前行的每个决策，需要利用dfs进行暴力递归，然后下一行继续尝试

这个dfs的过程会比较费时

轮廓线dp的原理

假设网格规模n*m，来到(i,j)位置时，状态信息表示一条轮廓线，具体来说

状态信息中的(0..j-1)位，用来表示i行，j列左侧的决策状况

状态信息中的(j..m-1)位，用来表示i-1行，j列右侧的决策状况

这样一来，可能影响(i,j)位置的决策，都被状态信息表示了

然后在(i,j)位置做完决策，调整好轮廓线信息之后，继续去往右侧做决策

不需要dfs的过程，时间复杂度只和动态规划表的总大小有关

空间压缩的版本一定要掌握，因为一旦卡空间，只有空间压缩的版本才能通过

题目2

贴瓷砖的方法数

给定两个参数n和m，表示n行m列的空白区域

有无限多的1*2规格的瓷砖，目标是严丝合缝的铺满所有的空白区域

返回有多少种铺满的方法

1 <= n, m <= 11

测试链接 : http://poj.org/problem?id=2411

题目3

相邻不同色的染色方法数

给定两个参数n和m，表示n行m列的区域

给定参数k，表示有k种颜色，颜色编号0~k-1

你需要给每个格子染色，但是相邻的格子颜色不能相同

相邻包括上、下、左、右四个方向

并且给定了第0行和第n-1行的颜色状况，其他格子没有颜色

那么你只能在1~n-2行上染色，返回染色的方法数，答案对376544743取模

2 <= k <= 4

k = 2时，1 <= n <= 10^7，1 <= m <= 10^5

3 <= k <= 4时，1 <= n <= 100，1 <= m <= 8

测试链接 : [https://www.luogu.com.cn/problem/P2435](https://www.luogu.com.cn/problem/P2435)

用两位表示一个格子的颜色，其他没啥了

题目4

摆放国王的方法数

给定两个参数n和k，表示n*n的区域内要摆放k个国王

国王可以攻击临近的8个方向，所以摆放时不能让任何两个国王打架

返回摆放的方法数

1 <= n <= 9

1 <= k <= n*n

测试链接 : https://www.luogu.com.cn/problem/P1896

本题同时需要(左、左上、上、右上)四个位置是否摆放过国王，那就一个增加可变参数

这样一来状态如何变化需要非常小心，代码不容易写，这一类问题都是难题

