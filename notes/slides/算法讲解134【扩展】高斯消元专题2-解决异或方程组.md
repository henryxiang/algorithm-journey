# 高斯消元解决异或方程组

前置知识

讲解030 - 异或运算

讲解032 - 位图

讲解133 - 高斯消元基本过程解析，专题第1节，视频前65分钟的内容，一定要掌握

高斯消元专题的讲述顺序

专题1：高斯消元解决加法方程组，讲解133

专题2：高斯消元解决异或方程组，讲解134，本节

专题3：高斯消元解决同余方程组，讲解135

以下内容在讲解133已经重点讲述，就是讲解133的视频前65分钟的讲述，请保证已经掌握

高斯消元流程图解，以加法方程组为例，但是解决其他方程组也一样

高斯消元如果需要严格区分：矛盾、多解、唯一解，流程图解

高斯消元解决任何方程组的理解重点

1，列出方程组，注意需要扩充方程组的情况：表达式冗余，补充变量；表达式不足，补充表达式

2，消元的过程，尤其是严格区分：矛盾、多解、唯一解，正确写法要掌握！

3，解是如何对应的，尤其注意主元和自由元的概念

4，矩阵最后结果的含义，主元可能依赖某些自由元才能决定值，但是自由元之间一定相互独立、互不影响

高斯消元的过程时间复杂度O(n^3)，n为扩充后的方程个数

本节课只是把加法方程组换成了异或方程组而已， _课上重点图解_

但是注意， _本节课对于主元可能依赖自由元才能决定值，有重点练习    _ 题目1    题目2

同时注意， _异或消元时如果元数比较多，可以用位图来表示每一行的状态，消元的常数时间更快    _ 题目3

题目1

高斯消元解决异或方程组模版题

有一个长度为n的数组arr，可能有重复值，数字都是long类型的正数

每个数拥有的质数因子一定不超过2000，每个数最多挑选一次

在至少要选一个数的情况下，你可以随意挑选数字乘起来

乘得的结果需要是完全平方数，请问有几种挑选数字的方法

方法数可能很大，结果对1000000007取余

1 <= n <= 300

1 <= arr[i] <= 10^18

测试链接 : https://acm.hdu.edu.cn/showproblem.php?pid=5833

题目2

全变成1的最少操作次数

一共有n个点，m条无向边，每个点的初始状态都是0

可以操作任意一个点，操作后该点以及相邻点的状态都会改变

最终是希望所有点都变成1状态，那么可能会若干方案都可以做到

那么其中存在需要最少操作次数的方案，打印这个最少操作次数

题目保证一定能做到所有点都变成1状态，并且没有重边和自环

1 <= n <= 35

1 <= m <= 595

测试链接 : [https://www.luogu.com.cn/problem/P2962](https://www.luogu.com.cn/problem/P2962)

题目3

外星千足虫

一共有n种虫子，编号1~n，虫子腿为奇数认为是外星虫，偶数认为是地球虫

一共有m条虫子腿的测量记录，记录编号1~m

比如其中一条测量记录为，011 1，表示1号虫没参与，2号、3号虫参与了，总腿数为奇数

测量记录保证不会有自相矛盾的情况，但是可能有冗余的测量结果

也许拥有从第1号到第k号测量记录就够了，k+1~m号测量记录有或者没有都不影响测量结果

打印这个k，并且打印每种虫子到底是外星虫还是地球虫

如果使用所有的测量结果，依然无法确定每种虫子的属性，打印"Cannot Determine"

1 <= n <= 1000

1 <= m <= 2000

测试链接 : [https://www.luogu.com.cn/problem/P2447](https://www.luogu.com.cn/problem/P2447)

