# 倍增算法和ST表

前置知识

讲解003、讲解006 \- 二进制基础、二分搜索基础

讲解041 \- 辗转相除法求最大公约数，本节课题目3需要

讲解066、讲解067、讲解068、讲解069 \- 动态规划基础，想系统学习动态规划看讲解066~讲解088

本节课讲述：

倍增算法、ST表

注意：

从下节课讲解118开始，会安排 _树上问题的专题，包括树上倍增、lca问题等等_

关于二进制的两个小问题

1，给定一个正数x，已知x一定可以用m个二进制位表示，从高位到低位打印x每一位的状态

2，给定一个正数x，打印<=x最大的2的幂，到底是2的几次方，要掌握防止溢出的写法

倍增算法和ST表

线段上有n个点，给定每个点i往右边跳1步能最远覆盖的点jump\[i\]

已知从任意点出发都能到达最后的点，并且在i < j时，必有jump\[i\] <= jump\[j\]

1）如何构建一张表

可以查询从任意点出发：跳1步、跳2步、跳4步、跳8步\.\.每回最远能到达的点

也就是可以查询，从任意点i出发，任意跳\(2的p次方\)步，最远能到达的点

2）如何快速计算任意的两点之间，最少跳几步能到达？

构建出的表叫做ST表\(Sparse Table\)

构建方式： _st\[i\]\[p\] = st\[\[i\]\[p\-1\]\]\[p\-1\]，p代表：跳2的p次方步_ ，表大小为n \* logn

利用ST表， _从x到y跳跃的过程中，先从最大步长开始，每次步长减少一半去尝试，最终得到答案_

时间复杂度O\(log n\)

课上重点图解

倍增算法 \+ ST表应用题目

题目1

国旗计划

给定点的数量m，点的编号1~m，所有点围成一个环

i号点一定顺时针到达i\+1号点，最终m号点顺指针回到1号点

给定n条线段，每条线段\(a\, b\)，表示线段从点a顺时针到点b

输入数据保证所有线段可以把整个环覆盖

输入数据保证每条线段不会完全在另一条线段的内部

也就是线段之间可能有重合但一定互不包含

返回一个长度为n的结果数组ans，ans\[x\]表示一定选x号线段的情况下

至少选几条线段能覆盖整个环

测试链接 : [https://www\.luogu\.com\.cn/problem/P4155](https://www.luogu.com.cn/problem/P4155)

构建更多类型的ST表，先解决一个实际的问题，然后再做总结

题目2

ST表维护最大值和最小值

给定一个长度为n的数组arr，一共有m次查询

每次查询arr\[l~r\]上的最大值和最小值

每次查询只需要打印最大值\-最小值的结果

测试链接 : [https://www\.luogu\.com\.cn/problem/P2880](https://www.luogu.com.cn/problem/P2880)

ST表的适用范围

如果A区间和B区间可能有重叠的部分

但是并不影响A\+B区间的答案，能通过 A区间答案 和 B区间答案 就加工出来

那么对应的区间询问，就是一个 _可重复贡献问题_

例如：区间最大值，区间最小值、区间公约数等，但是区间求和就不符合这个要求

再例如：区间按位与、区间按位或，ST表都能高效地解决

ST表的优势和劣势

RMQ问题\(Range Maximum/Minimum Query\)可以用ST表维护，也可以用线段树等结构维护

ST表的优势：构建过程时间复杂度O\(n \* logn\)，单次查询时间复杂度O\(1\)，代码量较小

ST表的劣势：需要空间较大，能维护的信息非常有限，不支持修改操作

题目3

ST表维护最大公约数

给定一个长度为n的数组arr，一共有m次查询

每次查询arr\[l~r\]上所有数的最大公约数

测试链接 : [https://www\.luogu\.com\.cn/problem/P1890](https://www.luogu.com.cn/problem/P1890)

ST表应用题目

题目4

出现次数最多的数有几个

给定一个长度为n的数组arr，该数组一定是有序的

一共有m次查询，每次查询arr\[l~r\]上出现次数最多的数有几个

题目查看 : https://www\.luogu\.com\.cn/problem/UVA11235

题目提交 : [https://vjudge\.net/problem/UVA\-11235](https://vjudge.net/problem/UVA-11235)

