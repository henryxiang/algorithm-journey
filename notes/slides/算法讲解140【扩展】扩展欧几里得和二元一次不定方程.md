# 扩展欧几里得和二元一次不定方程

前置知识

讲解139 \- 裴蜀定理和扩展欧几里得算法

上节课讲述

裴蜀定理及其证明，扩展欧几里得算法详解，常见题目解析

本节课讲述

扩展欧几里得算法和二元一次不定方程结合的内容，常见题目解析

二元一次不定方程，也叫丢番图方程\(Diophantine Equation\)，ax \+ by = c

扩展欧几里得算法可以对二元一次不定方程，进行解如何变化的讨论

a和b是不全为0的整数，d为a和b的最大公约数

如果ax \+ by = c，c不是d的整数倍，那么方程无整数解，否则有无穷多整数解。 _这是上节课内容_

如果ax \+ by = d，d为gcd\(a\,b\)，其中一个特解是\(x0\, y0\)

那么通解可以表示为： x = x0 \+ \(b/d\) \* n       y = y0 \- \(a/d\) \* n       n为任意整数

如果ax \+ by = c，c为d的整数倍，根据上面的特解，可以得到该等式的一个特解\(x0’\, y0’\)

其中，x0’ = x0 \* \(c / d\)，y0’ = y0 \* \(c / d\)

那么通解可以表示为： x = x0’ \+ \(b/d\) \* n      y = y0’ \- \(a/d\) \* n      n为任意整数

课上重点图解，如此一来，就有了讨论解如何变化的工具

题目1

二元一次不定方程模版

给定a、b、c，求解方程ax \+ by = c

如果方程无解打印\-1

如果方程无正整数解，但是有整数解

打印这些整数解中，x的最小正数值，y的最小正数值

如果方程有正整数解，打印正整数解的数量，同时打印所有正整数解中，

x的最小正数值，y的最小正数值，x的最大正数值，y的最大正数值

1 <= a、b、c <= 10^9

测试链接 : [https://www\.luogu\.com\.cn/problem/P5656](https://www.luogu.com.cn/problem/P5656)

题目2

青蛙的约会

有一个周长为l的环，从环的0位置开始，规定只能沿着顺时针方向不停转圈

青蛙A在环的x1位置，每秒跳m个单位，青蛙B在x2位置，每秒跳n个单位

只有在某时刻，青蛙A和青蛙B来到环的同一个位置，才算相遇

如果两只青蛙相遇不了，打印"Impossible"

如果可以相遇，打印两只青蛙至少多久才能相遇

1 <= l <= 3 \* 10^9

1 <= x1、x2、m、n <= 2 \* 10^9

x1 \!= x2

测试链接 : [https://www\.luogu\.com\.cn/problem/P1516](https://www.luogu.com.cn/problem/P1516)

题目3

格点连线上有几个格点

二维网格中只有x和y的值都为整数的坐标，才叫格点

给定两个格点，A在\(x1\, y1\)，B在\(x2\, y2\)

返回A和B的连线上，包括A和B在内，一共有几个格点

\-10^9 <= x1、y1、x2、y2 <= 10^9

测试链接 : [https://lightoj\.com/problem/how\-many\-points](https://lightoj.com/problem/how-many-points)

题目4

机器人的移动区域

二维网格中只有x和y的值都为整数的坐标，才叫格点

某个机器人从格点\(0\,0\)出发，每次机器人都走直线到达\(x \+ dx\, y \+ dy\)的格点

一共移动n次，每次的\(dx\, dy\)都给定，途中路线不会交叉，输入保证机器人最终回到\(0\,0\)

机器人走的路线所围成的区域一定是多边形，输入保证机器人一定沿着逆时针方向行动

返回多边形的内部一共几个格点，多边形的边上一共几个格点，多边形的面积

3 <= n <= 100

\-100 <= dx、dy <= 100

测试链接 : [http://poj\.org/problem?id=1265](http://poj.org/problem?id=1265)

鞋带公式 \+ Pick定理，课上重点图解

计算几何的更多内容，会在【挺难】阶段讲述

题目5

无法组成的最大值

一共有a、b两种面值的硬币，a和b一定互质，每种硬币都有无限个

返回a和b无法组成的钱数中，最大值是多少

题目的输入保证存在最大的无法组成的钱数

1 <= a、b <= 10^9

测试链接 : https://www\.luogu\.com\.cn/problem/P3951

